(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["drag-and-drop"],{7051:function(e,t,a){"use strict";a.r(t),a.d(t,"DragAndDrop",(function(){return T}));a("99af"),a("7db0"),a("caad"),a("4fad"),a("ac1f"),a("2532"),a("1276");var n=a("3835"),i=a("5530");a("a4d3"),a("c975"),a("b64b");function l(e,t){if(null==e)return{};var a,n,i={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}function r(e,t){if(null==e)return{};var a,n,i=l(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var u,c=a("d4ec"),o=a("bee2"),s=a("ade3"),v=800,d=null,g=null,h={id:null,date:null},f=!1,m=!0,_={el:null,cell:null,timeout:null},D={_eid:null,fromVueCal:null,toVueCal:null},T=(u=function(){function e(t){Object(c["a"])(this,e),Object(s["a"])(this,"_vuecal",void 0),this._vuecal=t}return Object(o["a"])(e,[{key:"_getEventStart",value:function(e){var t=this._vuecal,a=t.timeStep,n=t.timeCellHeight,i=t.timeFrom,l=t.utils,r=l.cell.getPosition(e),u=r.y;return u-=1*e.dataTransfer.getData("cursor-grab-at"),Math.round(u*a/parseInt(n)+i)}},{key:"_updateEventStartEnd",value:function(e,t,a,n){var i=1*a.duration||t.endTimeMinutes-t.startTimeMinutes,l=Math.max(this._getEventStart(e),0);if(this._vuecal.snapToTime){var r=l+this._vuecal.snapToTime/2;l=r-r%this._vuecal.snapToTime}t.startTimeMinutes=l,t.startDate=new Date(new Date(n).setMinutes(l)),t.start="".concat(t.startDate.format()," ").concat(t.startDate.formatTime()),t.endTimeMinutes=Math.min(l+i,1440),t.endDate=new Date(new Date(n).setMinutes(t.endTimeMinutes)),t.end="".concat(t.endDate.format()," ").concat(t.endDate.formatTime())}},{key:"eventDragStart",value:function(e,t){if(3===e.target.nodeType)return e.preventDefault();e.dataTransfer.dropEffect="move",e.dataTransfer.setData("event",JSON.stringify(t)),e.dataTransfer.setData("cursor-grab-at",e.offsetY);var a=this._vuecal.domEvents.clickHoldAnEvent;setTimeout((function(){a._eid=null,clearTimeout(a.timeoutId),t.deleting=!1}),0),this._vuecal.domEvents.dragAnEvent._eid=t._eid,D._eid=t._eid,D.fromVueCal=this._vuecal._uid,t.dragging=!0,setTimeout((function(){return t.draggingStatic=!0}),0),f=!1,h={id:this._vuecal.view.id,date:this._vuecal.view.startDate},m=!0}},{key:"eventDragEnd",value:function(e){this._vuecal.domEvents.dragAnEvent._eid=null,D._eid=null,e.dragging=!1,e.draggingStatic=!1;var t=D.fromVueCal,a=D.toVueCal;a&&t!==a&&this._vuecal.utils.event.deleteAnEvent(e),D.fromVueCal=null,D.toVueCal=null,f&&m&&h.id&&this._vuecal.switchView(h.id,h.date,!0)}},{key:"cellDragEnter",value:function(e,t,a){var n=this,i=e.currentTarget;if(!e.currentTarget.contains(e.relatedTarget)){if(i===_.el||!i.className.includes("vuecal__cell-content"))return!1;_.el&&(_.cell.highlighted=!1),_={el:i,cell:t,timeout:clearTimeout(_.timeout)},t.highlighted=!0,["years","year","month"].includes(this._vuecal.view.id)&&(_.timeout=setTimeout((function(){return n._vuecal.switchToNarrowerView(a)}),2e3))}}},{key:"cellDragOver",value:function(e,t,a,n){e.preventDefault(),t.highlighted=!0,(n||0===n)&&(t.highlightedSplit=n)}},{key:"cellDragLeave",value:function(e,t,a){e.preventDefault(),e.currentTarget.contains(e.relatedTarget)||(t.highlightedSplit=!1,_.cell===t&&(clearTimeout(_.timeout),_={el:null,cell:null,timeout:null},t.highlighted=!1))}},{key:"cellDragDrop",value:function(e,t,a,n){var l=this;e.preventDefault(),clearTimeout(_.timeout),_={el:null,cell:null,timeout:null};var u,c,o=JSON.parse(e.dataTransfer.getData("event")||"{}");if(D.fromVueCal!==this._vuecal._uid){o._eid,o.startDate,o.endDate;var s=o.duration,v=r(o,["_eid","startDate","endDate","duration"]);u=this._vuecal.utils.event.createAnEvent(a,s,Object(i["a"])({},v,{split:n}))}else u=this._vuecal.view.events.find((function(e){return e._eid===D._eid})),u||(u=this._vuecal.mutableEvents.find((function(e){return e._eid===D._eid})),c=!0);var d=u,g=d.startDate,h=d.split;this._updateEventStartEnd(e,u,o,a),c&&this._vuecal.addEventsToView([u]),u.dragging=!1,(n||0===n)&&(u.split=n),t.highlighted=!1,t.highlightedSplit=null,m=!1,D.toVueCal=this._vuecal._uid;var f=Object(i["a"])({event:this._vuecal.cleanupEvent(u),oldDate:g,newDate:u.startDate},(n||0===n)&&{oldSplit:h,newSplit:n},{originalEvent:this._vuecal.cleanupEvent(o),external:!D.fromVueCal});this._vuecal.$emit("event-drop",f),this._vuecal.$emit("event-change",{event:f.event,originalEvent:f.originalEvent}),setTimeout((function(){D._eid&&l.eventDragEnd(u)}),300)}},{key:"viewSelectorDragEnter",value:function(e,t,a){var i=this;e.currentTarget.contains(e.relatedTarget)||(a.highlightedControl=t,clearTimeout(d),d=setTimeout((function(){if(["previous","next"].includes(t))i._vuecal[t](),clearInterval(g),g=setInterval(i._vuecal[t],v);else if("today"===t){var e;clearInterval(g),i._vuecal.view.id.includes("year")&&(e=Object.entries(i._vuecal.views).find((function(e){var t=Object(n["a"])(e,2),a=t[0],i=t[1];return i.enabled&&!a.includes("year")}))[0]),i._vuecal.switchView(e||i._vuecal.view.id,new Date((new Date).setHours(0,0,0,0)),!0)}else i._vuecal.switchView(t,null,!0);f=!0}),v))}},{key:"viewSelectorDragLeave",value:function(e,t,a){e.currentTarget.contains(e.relatedTarget)||a.highlightedControl===t&&(a.highlightedControl=null,d&&(d=clearTimeout(d)),g&&(g=clearInterval(g)))}}]),e}(),u)}}]);